function o = Obj_function(x)
% 计算焊接梁设计问题的两个目标函数值
% 输入：
%   x - 输入变量向量，包括焊接梁的尺寸参数
% 输出：
%   o - 目标函数值向量，其中 o(1) 是重量目标，o(2) 是最大挠度

o = [0, 0]; % 初始化目标值向量

% 目标 1：重量最小化
o(1) = 1.10471 * x(1)^2 * x(2) + 0.04811 * x(3) * x(4) * (14.0 + x(2));

% 目标 2：最大挠度最小化
o(2) = 65856000 / (30 * 10^6 * x(4) * x(3)^3);

% 添加非线性约束惩罚值
o = o + getnonlinear(x);

% -------------------非线性约束处理函数---------------------
function Z = getnonlinear(x)
% 非线性约束惩罚项计算
% 输入：
%   x - 输入变量向量
% 输出：
%   Z - 违反约束的惩罚值

Z = 0;
lam = 10^15; % 约束惩罚常数

% 焊接梁设计问题的参数计算
Q = 6000 * (14 + x(2) / 2); % 作用力矩
D = sqrt(x(2)^2 / 4 + (x(1) + x(3))^2 / 4); % 弯矩作用点的距离
J = 2 * (x(1) * x(2) * sqrt(2) * (x(2)^2 / 12 + (x(1) + x(3))^2 / 4)); % 极惯性矩

% 剪切应力和最大弯曲应力的计算
alpha = 6000 / (sqrt(2) * x(1) * x(2));
beta = Q * D / J;
tau = sqrt(alpha^2 + 2 * alpha * beta * x(2) / (2 * D) + beta^2); % 最大剪切应力
sigma = 504000 / (x(4) * x(3)^2); % 最大弯曲应力

% 失稳约束计算
tmpf = 4.013 * (30 * 10^6) / 196;
P = tmpf * sqrt(x(3)^2 * x(4)^6 / 36) * (1 - x(3) * sqrt(30 / 48) / 28);

% 约束条件
g(1) = tau - 13600;  % 剪切应力约束
g(2) = sigma - 30000; % 弯曲应力约束
g(3) = x(1) - x(4);   % 尺寸约束
g(4) = 6000 - P;      % 失稳约束

% 没有等式约束，所以设置为空
geq = [];

% 计算违反不等式约束的惩罚项
for k = 1:length(g)
    Z = Z + lam * g(k)^2 * getH(g(k));
end

% 计算违反等式约束的惩罚项（此处为空）
for k = 1:length(geq)
   Z = Z + lam * geq(k)^2 * getHeq(geq(k));
end

% -------------------不等式约束的指示函数---------------------
function H = getH(g)
% 判断约束 g 是否被满足
% g <= 0 表示约束满足，返回 0；否则返回 1
if g <= 0
    H = 0;
else
    H = 1;
end

% -------------------等式约束的指示函数---------------------
function H = getHeq(geq)
% 判断等式约束 geq 是否被满足
% geq == 0 表示约束满足，返回 0；否则返回 1
if geq == 0
   H = 0;
else
   H = 1;
end
